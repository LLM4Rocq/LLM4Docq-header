
Matrix Similarity and Diagonalizability

Overview and Purpose
====================
This Coq source file formalizes fundamental theorems in linear algebra in finite dimension, that is, the theory of matrices over fields. Its primary focus is on the concepts of matrix similarity, conjugation, diagonalizability, and simultaneous diagonalizability (codiagonalizability), also called endomorphism reduction. The file develops a systematic theory of changing matrix representations via base change (conjugation), defines important transformations such as diagonalization and triangularization, and proves key equivalences characterizing when a matrix (or family of matrices) is diagonalizable—both individually and simultaneously. It also relates these properties to eigenspace decompositions and minimal polynomial factorizations.

The results and notions established here are building blocks for advanced topics in linear algebra, representation theory, and related areas where expressing linear operators in simple forms (diagonal or triangular) is important for computation and theoretical analysis.

Mathematical Objects and Their Representation
=============================================

- **Matrices Over a Field**: All matrices considered are over an abstract type `F` equipped with field structure, referred to as `fieldType`. The notation `'M[F]_n` or `'M[F]_(m, n)` is used for the space of `n×n` or `m×n` matrices with coefficients in `F`.

- **Matrix Conjugation (`conjmx`)**: 
   - Given matrices `V` (of appropriate size) and `f` (square), the conjugation (also called a change of basis) is defined as `conjmx V f = V *m f *m pinvmx V`, where `*m` is matrix multiplication and `pinvmx` computes a generalized inverse of `V`. 
   - This operation replaces the basis for the vector space on which `f` acts, re-expressing `f` in a (possibly new) basis.

- **Restriction of Matrices (`restrictmx`)**: For a matrix `V`, `restrictmx V f` denotes conjugation by the canonical basis-extracting matrix `row_base V`, i.e., a "restriction" of the linear map `f` to the image of `V`.

- **Similarity and Similarity Classes**:
   - The predicate `similar P A B` indicates that `A` is similar to `B` via conjugation by `P` (i.e., `conjmx P A = B`).

   - More generally, "Similarity in" and "to" predicates (`similar_in`, `similar_to` and  `similar_in_to`) parameterize the allowed base change matrix and/or the similarity class.

   - For instance predicate `similar_to P A C` holds if the conjugate `conjmx P A` belongs to `C`, expressing that the matrix `A` is similar to an element of `C` via the base change matrix `P`. This definition is mostly used as a technical device for defining diagonalizability, etc.

   - Similarly, predicate  `similar_in D A B` expresses that `B` is similar to `A` via a change of base which belongs to `D`. This definition is also mostly used as a technical device for defining co-diagonalizability, etc.

   - More specifically, `similar_diag P A` asserts that `A` is similar to a diagonal matrix via `P`.
   
   
- **Diagonalization and Codiagonalization**:
   - `diagonalizable A` indicates that the matrix `A` is similar to a diagonal matrix (with an invertible base change).
   - `codiagonalizable As` extends this to a sequence `As` of matrices: all of them are simultaneously diagonalizable in the *same* basis.
   - Analogous definitions are provided for triangular ("trigonalizable") matrices.

- **Polynomial and Eigenspace Machinery**:
   - The minimal polynomial (`mxminpoly f`) of a matrix and its properties under conjugation.
   - Eigenspaces, eigenvalues (`eigenspace f a`), and associated decomposition of the space, all implemented via structured subspaces of matrices.

- **Simultaneous Diagonalization, Commutativity**:
   - The file proves that a family of matrices is simultaneously diagonalizable if and only if each matrix is diagonalizable and the family is pairwise commutative (`comm_mx f g`).

- **Reflection Lemmas**:
   - Essential equivalences are expressed as `reflect` lemmas, bridging Boolean predicates and propositional statements.

Key Conventions and Notations
=============================

- ** Notations for Types and Operations**:
    - Square brackets denote type and size information: `'M[F]_n` for square matrices of size `n` with coefficients in `F`, `'M[F]_(m, n)` for rectangular matrices with `m` rows and `n` columns and coefficients in `F`.
    - `*m` is matrix multiplication; `A \in unitmx` expresses invertibility.
    - `pinvmx` computes a (possibly generalized) inverse, used to facilitate base changes even with non-invertible matrices. The `mx` suffix is used to characterize predicates and operations specific to matrices.

- **Scope and Implicits**:
    - `Set Implicit Arguments` and local notational conventions are used to minimize verbosity and maintain clarity.
    - The `ring_scope` is opened locally for convenience with ring and field operations.

- **Boolean Predicates and Reflection**:
    - Properties such as stability, similarity, diagonalizability, and commutativity are encoded as Boolean predicates (e.g., `stablemx`, `diagonalizable`).
    - Throughout, reflection lemmas relate these Boolean predicates to classical mathematical statements, aligning with the Ssreflect/MathComp proof methodology.

- **Hints and Automation**:
    - Core facts about diagonalization are made available through Coq's hint mechanisms for proof automation. These hints are made available to the `by` tactical and `done` tactic, as well as its `\\` variant.

- **Sectioning Pattern**:
    - The file is divided into logical sections (`ConjMx`, `Similarity`, `Diag`) to structure the development from the most general conjugation properties to specific diagonalization criteria and main theorems.

Summary of Main Results
=======================
- **Conjugation Laws**: Algebraic properties and interaction with stability, eigenvalues, and polynomials under conjugation.
- **Diagonalization Criteria**: 
    - A matrix is diagonalizable if and only if its minimal polynomial splits into distinct linear factors, or equivalently, if the direct sum of its eigenspaces is the whole space.
    - A sequence of matrices is simultaneously diagonalizable if and only if they commute pairwise and are individually diagonalizable.
- **Triangularization**: The file establishes the analogous results to that of diagonalization that hold for triangularization.
- **Effectiveness**: The file not only proves existence but provides explicit constructions (e.g., of base change matrices, eigenvalue lists).

Intended Use and Scope
======================
This file serves as a foundational module for anyone formally reasoning about linear operators, spectral theory, and canonical forms of matrices in the Rocq proof assistant. Its design encourages code and proof reuse in larger developments concerning the structure of linear transformations. All terminology, notations, and conventions used here are consistently used in the rest of the Mathematical Components library.

